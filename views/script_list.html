<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>控制台</title>
  <link rel="stylesheet" href="/static/layui/css/layui.css">
</head>

<body class="layui-layout-body">
  <div class="layui-layout layui-layout-admin">
    {{template "common/header.html" .}}
    {{template "common/sider.html" .}}
    <div class="layui-body">
      <!-- 内容主体区域 -->
      <fieldset class="layui-elem-field layui-field-title" style="margin-top: 10px;">
        <legend>脚本列表</legend>
      </fieldset>

      <table class="layui-hide" id="t_script" lay-filter="t_script"></table>
      <script type="text/html" id="barArea">
        <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
        <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
      </script>

    </div>
    {{template "common/footer.html" .}}
  </div>
  <script src="/static/layui/layui.js"></script>
  <script>
    layui.use('table', function () {
      var table = layui.table
        , form = layui.form;

      table.render({
        elem: '#t_script',
        url: '/web/script/list',
        cellMinWidth: 80, //全局定义常规单元格的最小宽度
        page: {
          layout: ['limit', 'count', 'prev', 'page', 'next'], //自定义分页布局
          curr: 1, //设定初始在第 1 页
          groups: 1//只显示 1 个连续页码
        },
        cols: [[ //标题栏
          { field: 'hospitalName', title: '机构名称', sort: true }
          , { field: 'dataType', title: '数据类型' }
          , { field: 'description', title: '脚本描述' }
          , { field: 'scriptName', title: '脚本名称' }
          , { field: 'status', title: '状态' }
          , { field: 'operate', title: '操作', toolbar: '#barArea' }
        ]]
      });
      
      table.on('tool(t_script)', function (obj) {
        var data = obj.data;
        console.log(obj)
        if (obj.event === 'del') {
          layer.confirm('真的删除行么', function (index) {
            obj.del();
            layer.close(index);
          });
        } else if (obj.event === 'edit') {
          layer.msg("修改成功")
        }
      });
    });
  </script>
</body>

</html>